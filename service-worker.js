let e="resources-initial",t="content-initial";function c(e,t,c){clients=self.clients.matchAll().then(a=>{a.map(a=>{"visible"===a.visibilityState&&a.url===c&&a.postMessage({type:"cachebust",max:parseInt(e),contentCacheExpires:parseInt(t)})})})}async function a(){if("".length){const c=await fetch("REPLACE_WITH_PRECACHE_URL",{cache:"no-cache",credentials:"include",headers:new Headers({Accept:"application/json"})}),a=await c.json();c.ok&&((null==a?void 0:a.resources)&&event.waitUntil(caches.open(e).then(e=>e.addAll(a.resources))),(null==a?void 0:a.content)&&event.waitUntil(caches.open(t).then(e=>e.addAll(a.content))))}}self.addEventListener("fetch",c=>{if(c.request.url.match(new RegExp(/(\.json)$|(cachebust\.js)/gi))||"GET"!==c.request.method)c.respondWith(fetch(c.request));else{const a=c.request.url.match(new RegExp(/(\.js)$|(\.css)$|(\.mjs)$|(\.cjs)$|(\.png)$|(\.jpg)$|(\.gif)$|(\.webp)$|(\.jpeg)$|(\.svg)$/gi))?e:t;c.respondWith(caches.match(c.request).then(e=>e||fetch(c.request,{redirect:"follow"}).then(e=>{if(!e||200!==e.status||"basic"!==e.type||"no-cache"===e.headers.get("PWA-Cache")||e.redirected)return e;var t=e.clone();return caches.open(a).then(e=>{e.put(c.request,t)}),e})))}}),self.addEventListener("message",n=>{const{type:s}=n.data;switch(s){case"cachebust":!async function(n){await async function(){const t=await fetch("/resources-cachebust.json",{cache:"no-cache",credentials:"include",headers:new Headers({Accept:"application/json"})});if(t.ok){const c=await t.json();e="resources-"+c.cacheTimestamp,caches.keys().then(t=>Promise.all(t.map(t=>{if(new RegExp(/resources/i).test(t)&&t!==e)return caches.delete(t)})))}}(),await async function(e){const a=await fetch("/cachebust.json",{cache:"no-cache",credentials:"include",headers:new Headers({Accept:"application/json"})});if(a.ok){const n=await a.json();t="content-"+n.cacheTimestamp,caches.keys().then(e=>Promise.all(e.map(e=>{if(new RegExp(/content/i).test(e)&&e!==t)return caches.delete(e)}))),c(n.maximumContentPrompts,n.contentCacheDuration,e)}else"content-initial"===t&&(t="content-"+Date.now(),caches.keys().then(e=>Promise.all(e.map(e=>{if(new RegExp(/content/i).test(e)&&e!==t)return caches.delete(e)})))),c(4,7,e)}(n),await a()}(n.data.url);break;case"page-refresh":!async function(e,c){try{const a=new Request(e);await new Promise(e=>{caches.open(t).then(t=>{t.delete(a).then(()=>{e()})})}),"4g"===c&&await new Promise(c=>{fetch(e,{credentials:"include"}).then(e=>{e&&200===e.status&&"basic"===e.type||c(),caches.open(t).then(t=>{t.put(a,e),c()})})});(await self.clients.matchAll()).map(t=>{"visible"===t.visibilityState&&t.url===e&&t.postMessage({type:"page-refresh"})})}catch(e){}}(n.data.url,n.data.network);break;case"clear-content-cache":caches.keys().then(e=>Promise.all(e.map(e=>{if(e.match("content"))return caches.delete(e)})))}});