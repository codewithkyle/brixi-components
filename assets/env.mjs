export const env=new class{constructor(){var e;this.handleNetworkChange=()=>{this.connection=window.navigator.connection.effectiveType,sessionStorage.removeItem("connection-choice")},this.memory=4,this.cpu=(null===(e=window.navigator)||void 0===e?void 0:e.hardwareConcurrency)||2,this.threadPool=this.cpu-2,this.connection="4g",this.domState="loading",this.dataSaver=!1,this.browser="unknown",this.setBrowser(),this.tickets=[],this.init()}init(){"connection"in navigator&&(this.connection=window.navigator.connection.effectiveType,this.dataSaver=window.navigator.connection.saveData,navigator.connection.onchange=this.handleNetworkChange.bind(this)),"deviceMemory"in navigator&&(this.memory=window.navigator.deviceMemory)}stopLoading(e){if(e&&"string"==typeof e){for(let t=0;t<this.tickets.length;t++)if(this.tickets[t]===e){this.tickets.splice(t,1);break}0===this.tickets.length&&"loading"===this.domState&&(this.domState="idling",document.documentElement.setAttribute("state",this.domState))}}startLoading(){"loading"!==this.domState&&(this.domState="loading",document.documentElement.setAttribute("state",this.domState));const e=this.uid();return this.tickets.push(e),e}uid(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}setDOMState(e){this.domState=e,document.documentElement.setAttribute("state",this.domState)}checkConnection(e){let t=!1;switch(e){case"4g":"2g"!==this.connection&&"slow-2g"!==this.connection&&"3g"!==this.connection&&(t=!0);break;case"3g":"2g"!==this.connection&&"slow-2g"!==this.connection&&(t=!0);break;case"2g":"slow-2g"!==this.connection&&(t=!0);break;case"slow-2g":default:t=!0}return t}setBrowser(){const e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t="undefined"!=typeof InstallTrigger,n=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),o=!!document.documentMode,i=!o&&!!window.StyleMedia,s=!!window.chrome,r=s&&-1!=navigator.userAgent.indexOf("Edg");this.browser=e?"opera":t?"firefox":n?"safari":o?"ie":i?"edge":s?"chrome":r?"chromium-edge":"unknown",document.documentElement.classList.add(this.browser)}reserveThread(){return new Promise((e,t)=>{this.threadPool-1<0?t("Thread pool is empty"):(this.threadPool--,e())})}releaseThread(){this.threadPool++}};export const uid=env.uid;export const dataSaver=env.dataSaver;export const browser=env.browser;export const checkConnection=env.checkConnection.bind(env);export const reserveThread=env.reserveThread.bind(env);export const releaseThread=env.releaseThread.bind(env);